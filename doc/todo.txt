- Seems paths being reported by 'store' are still not quite right
  (missing parts between given path and last segment?)
  example:
	put x-rdfified:file:./01 file:///home/tog/datastore/ccouch/data/user/D6/D6TUSFTYCUWE4WRJCPKMHWOQAAMY6XKS
	put x-rdfified:file:./2007 file:///home/tog/datastore/ccouch/data/user/RX/RXUIHNFTEBHF3RUMZ4AI7RW3EV2PVIZZ
	put x-rdfified:file:./08 file:///home/tog/datastore/ccouch/data/user/BS/BSTBMRATPJA6LU2YKUCOUMBOUJU2WIAK
	put x-rdfified:file:./2008 file:///home/tog/datastore/ccouch/data/user/34/34IQE6IGIPU6S4BFFXCLUZNHE744X26P
	put x-rdfified:file:./ file:///home/tog/datastore/ccouch/data/user/BK/BKRCYIV4KBRRSQVE3W6EZS62SBYKLQL3

- Data format overhaul
  - Should still support old formats!
    - options to force writing in old or new format
    - default to old if sufficient for representing object and if
      identical RDF blob exists 
  - x-parse-rdf: -> x-rdf-subject:
  - RdfNodes should not be same object as subject
    - Something like RdfConversion.getRdfSubject( RdfNode ... )
    - RdfNodes are also refs
      - e.g., the following would be equivalent:
        <prop rdf:ref="http://blah"/>
        <prop><rdf:Description rdf:about="http://blah"/></prop>
      - would more easily allow metadata in directory entries
  - new directory entry format:
    - removes need for 'targetType', 'targetSize' nonsense
    - modification time is still a property of the entry, not the target
    - e.g.
      <DirectoryEntry>
        <name>a place</name>
        <dc:modified
        <target>
          <Directory rdf:about="x-rdf-subject:..."/>
        </target>
      </DirectoryEntry>
      <DirectoryEntry>
        <name>a place</name>
        <target>
          <Blob rdf:about="urn:sha1:...">
            <dc:size>12345</dc:size>
            <dc:format>text/awsum</dc:format>
          </Blob>
        </target>
      </DirectoryEntry>

- 'store' does not add an updated commit to heads/ when the parent commit
  (even if not in heads/) would have the same target.
  - Use separate checks for 'create new commit' (only when target differs
    from parent's), and 'store updated commit' (only when previous commit
    in heads/ has different target).

- Implement changeset merging, 'update' command
  - CommitUtil.findCommonAncestor( Commit a, Commit b )
  - CommitUtil.getChangesBetween( Commit old, Commit new )
  - CommitUtil.applyChanges( changes, WritableDirectory )
  - CommitUtil.update( WritableDirectory, Commit current, Commit new )

- 'check' does not default properly, or it doesn't actually use URIs, only
  working when given a filesystem path.  It should probably be able to run
  using arbitrary URIs.

- Update documentation
  * Help given by ccouch id <invalid option> is wrong
  * README is out of date
  - doc/ is full of outdated stuff

- RDFify should have option to use alternate RDF writing method for large documents
  - RDFDirectory objects would not be created - data would be serialized more directly
  - Would write standard namespaces out first
  - Non-standard namespace declarations would be included as needed
  - Would write one element at a time to a stream - no need for buffering 

- Metadata stores
  - Any number of metadata stores (similar to how data/ is divided into user-specified 'sectors')
  - Probably backed by lucene
  - Active function to return a list of metadata items from a query
    (has tag X, date < Y, get only the latest 10, sorted by date descending, etc)
  - Active function to create directory from a list of metadata items,
    generating entry targets, names, and modification times based on
    the metadata.
  - Sub-command to import metadata into datastore from RDF files
  - Sub-command to export metadata as RDF based on a query
  - Allow metadata 'documents' to be signed?  Metadata may then be able to take the place of 'heads'.

- Allow pushing to remote repositories over HTTP
  - Service to take a list of URIs and return those of blobs not present on the server
  - On web server, option to allow validated blobs to be pushed to certain sectors
    - Require SHA-1 to be passed in, and blob must match
    - Option to only allow RDF blobs in certain sectors
    - Only allow from [certain] authenticated users
  - POST .../missing-blob-list with \n-separated urn:sha1:... content
  - PUT .../data/<sector>;uri=urn:sha1:...

- RdfNodes ought to read relative URIs as relative to the node's source URI.
  - I don't think I ever did this.
  - This is very low priority, since all RDF docs currently used only contain absolute URIs.

== Done ==

* Create functions to help make photo album pages
  * Cache results of active functions in the datastore, remembering active:... -> urn:... mapping
  * Function to create listing of photos referencing thumbnails
    /process?processor=contentcouch.photoalbum.make-album-page&uri=x-parse-rdf:urn:sha1:OCJIRSUCWLZGHKM5DXHDYQDI5IU6VVTD

* Checkout causes a lot of x-undefined:source URIs to be reported; change to report actual source when possible.

* When comparing files for 'Strict' merge method (which is very useful!),
  use cached content URNs when they are available (e.g. when source URI is
  given or the blob is a FilbBlob and URNs are comparable).
  This used to work but was never re-implemented on RRA branch.

* Remember the repository most recently successfuly downloaded from and
  download from it first.

* Better logging infrastructure
  - Don't show 'GET xxx' message unless logging for that is turned on 

* While caching heads, should store heads in cache datastore, not just heads dir

* When downloading blobs from remote repos, if one repo gives a bad blob, try the next repo instead of just dying.

* A single repository should be able to store separately:
  - data/user   (what the user tells it to store)
  - data/remote (blobs cached from remote repositories)
  - data/active (cached function call results)
  so that users don't have to set up 10 different repositories

* URIs stored in .ccouch-commit-uris should be like x-parse-rdf:urn:sha1:..., not like
  x-parse-rdf:x-ccouch-head:togos-win/togos-image-archives/latest 

* Use TheGetter to get the generic getter.

* RequestHandlers as a more featurified alternative to Getters

* Centralize path handling
  * Be able to create a URI to follow a path into any Directory
  * appendPath('active:xyz', 'ferb/gerb') = 'active:follow-path+source@active:xyz+path@data:,ferb/gerb' 
  * appendPath('foo/bar', 'ferb/gerb') = 'foo/bar/ferb/gerb'
  * option to require '/' after last directory or not for path-based URIs
 
